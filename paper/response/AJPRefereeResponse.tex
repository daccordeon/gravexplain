\documentclass{article}

\usepackage{fullpage}
\usepackage{xcolor}
\newcommand{\todo}{\textcolor{blue}}
\newcommand{\han}{\textcolor{orange}}
\newcommand{\jam}{\textcolor{magenta}}


\begin{document}

\todo{Opening comments}\\


Dear Joseph Amato, 

We thank you and the referees for your helpful comments and suggestions. 
We address the comments below in turn. 

\subsection*{Comments from editor, Joseph Amato}
\begin{quote}
This is an addendum to my decision letter and the two reviews of your manuscript.  I am satisfied that the reviewers read your work carefully, and that their recommendations are fair, thoughtful, and potentially useful.  While I sympathize with R1’s concern that the manuscript is better suited to a research journal, I think it could be revised to make a valuable contribution to AJP, which, as you know, is geared toward pedagogy.  So as I read your manuscript, I recorded things that were not sufficiently clear to me, supposing that the same things might not be clear to many AJP readers who might be very interested in duplicating your apparatus.  Here are some of my concerns.
\end{quote}

\noindent 1. Simple things: Convert footnotes to endnotes, blending them in with the bibliography.  Also, use US English (color, not colour; defense, not defence, etc.). 
\begin{itemize}
\item We have moved the footnotes to the bibliography
\item \todo{Work in progress, please correct any that have not been fixed yet}
\end{itemize}

\noindent 2. Section III.  How was the Fourier transform generated?  (software?)
\begin{itemize}
\item Yes, the Fourier transform was generated using software. We have added a sentence to Section III (``The Discrete Fourier transform was calculated using the NumPy package for Python.''), a citation (to the creators of NumPy), and a footnote (to the documentation).
\end{itemize}

\noindent 3. Section IV.  The term “Markov process” may not be familiar to readers.  Figure 4: The three shades (or are there four?) indicating probability do not show up well in color, and worse, will be indistinguishable in black/white.  I’m guessing that’s the reason I didn’t understand why certain paths were grey and not black.  While I applaud your efforts to explain the Viterbi algorithm (VA), I still think there’s room for improvement.  I don’t understand how it improves the signal to noise ratio. 
\begin{itemize}
\item We have added a sentence to explain Markov process: ``In a Markov process, the current state depends only on the previous state (in this case the state is the frequency of the signal).''
\item We have lightened the colour scheme used in the Fig. 4 schematic to aid with black and white printing. Our intention is that the Fig. 4 schematic be interpreted as a simplified version of the Fig. 5 spectrogram result. To clarify this we have made the colour scheme of the schematic more consistent with that of Fig. 5 and we have refered back to the schematic when we first introduce Fig. 5. 
\item The hidden Markov model and Viterbi algorithm's strength is in it's ability to find randomly wandering signals. The single constant tone in section III is recovered easily using a Fourier transform, however if the signal frequency changes over time, the signal power is spread across multiple frequency bins. We have added a new figure to illustrate this (Fig. 4) and some text at the start of Section IV (paragraph 2) and at the end of Section IV. B. to explain that the Fourier transform of the whole dataset is not well suited to this type of signal.
\item We have also revised the entire Section IV to improve clarity in our Viterbi algorithm explanation and motivation.
\end{itemize}


\noindent 4. Figure 5 is described as a heatmap.  Please explain, in the caption, what the color coding indicates.  Can you compare what is shown to what would be detected without using the VA?  Is this ``heatmap'' the same representation as is often shown in LIGO publications?
\begin{itemize}
\item The color coding represents the logarithm of the absolute value of the discrete Fourier transform. We have clarified this in the caption.
\item Without using the VA the signal becomes spread out over the frequency bins and might not rise above the noise. We have now explained this and added a plot that shows the Fourier spectrum of the entire timeseries.
\item The heatmap is similar to the figures in LIGO-Virgo-KAGRA publications which show transient gravitational-wave signals, but not identical. Those figures normally show Q-transforms [described in Chatterji, et al., Classical Quantum Gravity 21, S1809 (2004)] whereas we show the Fourier transform in this work. We have not drawn comparisons the the Q-transform plots in order to avoid confusion.
\end{itemize}


\noindent 5. Section V.  What do you mean by an optical microphone device?  “Cloth screen” over the photodiode?  Fig. 6 is unnecessary; the differences from Fig. 1 are explained clearly in the text.
\begin{itemize}
\item Optical microphone: we have rearranged the text so that the optical microphone concept is introduced in a separate paragraph and expanded our discission of it to improve clarity. (Section V, paragraph 2)
\item Fig. 6: agreed, we have removed this figure and moved the photo to the Supplementary Material.
\item The cloth screen was used to reduce the intensity of light on the photodiode and avoid saturating the analog-to-digital converter. It was indeed an improvised solution using the ``grill cloth'' and plastic frame from the dismantelled commercial speaker used in the demonstration. We have added a sentence to Section V.A. to clarify.
\end{itemize}  



\noindent 6. Figure 7: why is there a -100 dB difference in the signal level from 7a to 7b?  
\begin{itemize}
\item The Butterworth filter has strongly attenuated the signal outside the passband, this sharp drop-off at low frequencies would appear shallower when shown against a logarithmic scale for frequency as is sometimes done. A note has been made in the Supplementary Material where this plot has been moved to.
% (this sharp drop-off would appear shallower when shown against a logarithmic scale for frequency)
% \item \todo{They will also expect a change to the paper as it is a point of confusion - e.g. clarify the reason in the figure caption.}
\end{itemize}


\noindent 7. Much of your description of the various filters should be moved to Supplementary Materials and/or referenced.  This is a physics audience.  More interesting is your observation that all filters degrade the signal in some way, i.e., they are all compromises.  You could usefully expand that argument without becoming overly mathematical.
\begin{itemize}
\item Agreed, we have moved the majority of this section to Supplementary Material. We have chosen to show two highlight results in the main text (the combined notch plus Wiener filter and the logMMSE estimator), but we refer the reader to the Supplementary Material for the details of these methods. We have also expanded the discussion on filters more generally in the main text. 
\end{itemize}


\noindent 8.Where in your flowchart are the various filters you describe?  Are the codes for them readily available?  How does one implement a filter?  
\begin{itemize}
\item The filters are performed separately after the data is gathered. We have added a sentence to the figure caption to clarify this. 
\item Most of the code is readily available on the provided GitHub with the exception of the Weiner filtering results. The provided code is documented and commented if someone wanted to replicate the filter implementations.
\item \todo{We may need to have access to Changrong's processing code}
\item \todo{...}
\end{itemize}


\noindent So you see that I'm asking for a major revision of your manuscript.  I hope this does not discourage you.  My goal is to expand the size of the audience reading your article, and to increase its utility for that group of educators.  I look forward to a revised manuscript.



\subsection*{Comments from R3}

\begin{quote}
The paper describes a table top interferometer for demonstrating the basic operating principles of gravitational wave (GW) detectors. Audio signals are used to demonstrate gravitational wave data analysis techniques for the detection and estimation of signals in noisy data. The paper is well written and will be of interest to educators who wish to provide some hands-on training to students in GW astronomy. I have some comments below that the authors should address.
\end{quote}

\noindent 
-- The data analysis problems discussed in this paper are related to continuous wave searches. However, I did not find a mention of the key feature involved in these searches, namely, Doppler modulation of the signal frequency caused by the rotation of the Earth. This is the principal reason behind the extremely high computational cost of CW searches. A discussion of doppler modulation should be included. (It would be neat if the setup could be extended in the future to show the Doppler effect.)
\begin{itemize}
\item We have including some details on this in the description of detection statistics in section IV.A. and have also added that Doppler modulation of the source also needs to be taken into account if searching for a neutron star in a binary. 
\item \todo{...}
\item A mention has been made in the Future Work as to demonstrating the Doppler effect.
 \todo{...}
\end{itemize}

\noindent
-- Is the HMM defined properly in Sec. IV A? The observables here are the amplitudes of the spectrogram pixels at a given time index and the hidden markov process is the underlying drift of frequency and amplitude of the signal. I was expecting to see a conditional pdf that connects the state of the underlying (suitably discretized) process to the observables. I don't see it.
\begin{itemize}
\item We have clarified the explanation of the HMM in the text. The detection statistic captures the likelihood of a signal being present in each time-frequency bin given the observable data. In Section IV.A. we have expanded our description of gravitational wave analysis and referred to both the transmission matrix and emission matrix by name to reduce confusion. 
\end{itemize}

\noindent
-- Is Eq. 1 correct? The LHS is a marginal probability while the RHS is a joint probability. Shouldn't there be a marginalization on the RHS?
\begin{itemize}
\item This equation was indeed incorrect and we thank you for the careful review. The equation should give the probability for a specific path, and is not a sum over all possibilities. We have corrected Eq. 1 and added clarification to the text. 
\end{itemize}

\noindent
-- The normalization used for $F(t_i, f_j)$ should be defined explicitly. 
\begin{itemize}
\item Each value is divided by the maximum value in the grid such that $\max_{i,j} F(t_i, f_j) = 1$. We have added this information to section IV.B.
\end{itemize}

\noindent
-- Looking at Fig. 3, it appears that the noise is not white and rises in power at lower frequencies. How is the color of the noise taken into account, if at all, in the HMM or the Viterbi algorithm? A discussion of this point should be included although it is fine to assume white noise as a first approximation. 
\begin{itemize}
\item We do assume that the noise is white in our analysis. We have added some text to clarify this at the start of Section IV.C.
\end{itemize}

\noindent
-- The Viterbi algorithm used in this paper falls along the general lines of finding the optimal path through a chirplet graph (which includes the spectrogram) that has been explored extensively in the GW literature. More broadly, the detection and estimation of chirp signals, which leave a track in the time-frequency plane, has been a topic of many papers. For the benefit of the readers, the authors should provide an expanded literature review in Sec. IV A and state clearly if their approach is new and, if so, how it differs from the existing ones. A partial list of papers is given below: \\    
* E. Chassande-Mottin and A. Pai, Phys. Rev. D 73, 042003 (2006). \\
* E. J. Candes, P. R. Charlton, and H. Helgason, Classical Quantum Gravity 25, 184020 (2008).   \\
* W. G. Anderson and R. Balasubramanian, Phys. Rev. D 60, 102001 (1999).   \\
* P. Addesso, M. Longo, S. Marano, V. Matta, I. Pinto, and M. Principe, in 2015 3rd International Workshop on  Compressed Sensing Theory and its Applications to Radar, Sonar and Remote Sensing (CoSeRa) (IEEE, New York, 2015), p. 154.   \\
* E. Thrane et al., Phys. Rev. D 83, 083004 (2011).   \\
* E. Thrane and M. Coughlin, Phys. Rev. D 89, 063012 (2014).    \\
* S. D. Mohanty, Phys. Rev. D  D 96, 102008 (2017).   \\
* Margaret Millhouse, Neil J. Cornish, and Tyson Littenberg, Phys. Rev. D 97, 104057 (2018).\\
\begin{itemize}
\item The Viterbi algorithm is not a new approach for gravitational wave analysis. It is used in many searches for continuous waves to date \todo{refs} and the methods papers are Refs \todo{refs}. We use these existing methods as inspiration and apply them to this table-top experiment in order to demonstrate the real gravitaitonal wave searches using sound. It is important to clarify that we are not searching for chirp signals in this work, we are simulating a signal with wandering frequency as an analoge to continuous wave signals whose frequencies can wander stochastically over time. 
\item [what we have done]. We have clarified that the method is not new in a new subsection in section IV (section IV A) reviewing how these methods are used in gravitational wave analysis before describing our application of the methods in this work. \todo{We also add references to a ......}
\item \han{[from Hannah] These papers are addressing how to detect an unknown chirp signal from a compact binary merger. I think it may be relevant in some cases, but will take a look at the papers. We should also emphasise that the analysis is not new and that we have referenced the papers for the techniques we use. }
\end{itemize}

\noindent
-- Sec VC: I feel that this section too long and is trying to fit too much of digital signal processing (DSP) in a limited space. The topic of digital filtering is not something that Physics undergraduates (or even graduates) are usually familiar with and requires a more gentle introduction than provided here. For example, the term "IIR" is introduced without explaining what the impulse response of a filter is (and there is no mention of FIR filters). Similarly, Eq. 4 looks like a Z-transform, and advanced topic in itself, but this is not mentioned and instead the term "complex frequency" is used that is likely to be unfamiliar to most readers. (Incidentally, there seems to be a notational inconsistency across the two sides of Eq.3: 'f' and 'omega'.) To improve the readability of the paper, the authors should consider shortening this section by focussing on only the filtering procedure that worked the best. References to DSP textbooks may be provided for the interested reader to acquire background material. 
\begin{itemize}
\item We have move the majority of Section VC to Supplementary Material and now only include highlight results in the main text (the combined notch plus Wiener filter and the logMMSE estimator). In the Supplementary Material we have expanded the description of the impulse response of a filter mentioning both IIR and FIR. We have also added some text saying that Eqn. 2 in the Supplementary Material (previously Eqn. 4 in the main text) is a Z-tranform. We have corrected the inconsistency in Eqn. 1 in the Supplementary Material (previously Eqn. 3 in the main text). 
\todo{add some references to DSP textbooks.}
\end{itemize}

\noindent
-- While the authors have applied standard filtering methods in Sec. VC, the removal of high power line features from data in GW detectors is done using more sophisticated approaches. For example, cross-channel regression, linear predictive filtering, Kalman filtering etc. There are also some non-linear and non-parametric methods that have been explored in the GW literature. This point should be mentioned in the paper.
\begin{itemize}
\item \todo{...}
\end{itemize}

\noindent
-- The axes label for frequency is not consistent across the figures: in some plots it is "f/Hz" and others "f(Hz)".
\begin{itemize}
\item We have corrected the axis labels and they are now consistent.
\end{itemize}

\noindent
-- This is not a comment but just my curiosity: How strong is the effect of mechanical vibrations of the camera or photodiode mount on the observed signal?
\begin{itemize}
\item This is unknown to us but has now been mentioned in Future Work.
\end{itemize}



\subsection{Comments from R1}

\begin{quote}
This is a very interesting paper written in a clear and informative language. However, I don’t think that it suits the style of papers in AJP because it represents a novel idea of teaching and exploring gravitational waves with audio signals. After reading and inspection of the manuscript I came to the  conclusion  that it is a  research  paper  which should pass  through critical discussion  with researchers  from gravitational  wave  community who  should  confirm  that  the audio signals produced in the way proposed in the manuscript, can indeed mimic real gravitational wave signals without confusion of students and teachers. Gravitational waves are transverse-traceless while the sound waves are purely longitudinal. In this respect there is no analogy between gravitational waves and audio signals whatsoever. At the same time, the principles of extraction of signal from noise and the filtering technique worked out in the manuscript are applicable in a wide range of physical disciplines and may be useful for the gravitational wave community as well. On the other hand, I cannot imagine how teachers of physics will explain the complexity of the Wiener filter, the Markov chain, the Viterbi algorithm to high school students or even to undergraduate students in university college. Signal processing technique is based  on a  high  level  mathematics (statistics, probability theory, stochastic processes, etc.) and engineering. In my opinion, the paper is too complicated both technically and mathematically for publishing in AJP. I am convinced that this is a very good and high-quality research  paper but  my  fair  opinion  is  that the authors should submit  it  to  Physical Review D or another peer-review physics journal. 
\end{quote}

\begin{itemize}
\item \todo{...}
\item \han{> Thoughts on this [Hannah]: The use of audio as an analogy to gravitational waves is not novel to this work. Sound has been used in numerous situations to convey the concept of gravitational wave signals to general audiences [will add references]. It is of course true that sound is not the same as gravitational waves, however in this work we are focusing on the extraction of a signal from an interferometer to demonstrate a series of analysis techniques, some of which are related to gravitational wave analysis. [will think about this some more and very happy to hear other thoughts on how we respond here -Hannah]}
\item \jam{(1) The audio analogy is not novel, (2) the interferometer is a toy model for demonstration and teaching not for research, i.e.\ I doubt our analysis techniques are useful to the gravitational wave community in any novel way, (3) as long as we are clear in the text (todo added below) about the difference and that we are demonstrating the analysis techniques then I think that there isn't an issue, (4) we have heavily edited the signal processing section and worked on the Viterbi algorithm section which I believe (the Viterbi algorithm) is understandable to even high-school students if the explanation without using Markov models or Fourier transforms is given, i.e. the pseudocode.  - James}
\item \todo{Clearly state the differences between gravitational waves and sound waves in the text but reiterate that despite these differences our demonstration is still useful to explain signal analysis techniques used for gravitational waves.}
\end{itemize}




\end{document}

